USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;

INSERT INTO SUPERMERCADO 
		(SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES	("111111111", "Supermercado Grick", "(11) 91234-5678", "gricktambau@email.com", "Grick Street", "1000", "Tambacity", "SP"),
		("222222222", "Mercadinho Bom Preço", "(21) 99876-5432", "contato@bompreco.com", "Rua das Flores", "250", "Campolândia", "RJ"),
		("333333333", "Supermais Atacado", "(11) 93456-7891", "vendas@supermais.com", "Avenida Central", "1200", "Paulistânia", "SP"),
		("444444444", "Mercado Econômico", "(31) 97654-3210", "economico@email.com", "Travessa das Acácias", "45", "Sol Nascente", "MG"),
		("555555555", "HiperLuz", "(41) 98877-6655", "atendimento@hiperluz.com", "Rua do Comércio", "800", "Nova Esperança", "PR");
        
INSERT INTO PRODUTO 
		(PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES	("2554589548985", "Arroz 5kg", 5.0, 500, 26.90, "2025-12-25"),
		("7896541230012", "Feijão Carioca 1kg", 1.0, 350, 8.50, "2026-03-10"),
		("7893214567789", "Açúcar Refinado 1kg", 1.0, 400, 5.30, "2026-01-20"),
		("7899876543321", "Café Torrado 500g", 0.5, 200, 12.90, "2025-11-30"),
		("7891237896543", "Macarrão Espaguete 500g", 0.5, 300, 4.70, "2026-02-15");
        
INSERT INTO CONSUMIDOR 
		(CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES	("45982972800", "Fernanda Silva do Amaral", "19998909834", "fernanda.amaral220608@gmail.com"),
		("38294651720", "Lucas Andrade Costa", "21997341256", "lucas.andradec@gmail.com"),
		("57129846311", "Mariana Oliveira Santos", "11985273419", "mariana.santos_oliv@gmail.com"),
		("69481235790", "Rafael Lima Pereira", "31994027658", "rafael.limapereira@gmail.com"),
		("84592316708", "Beatriz Souza Almeida", "41998764325", "beatriz.almeida.s@gmail.com");
        
INSERT INTO FUNCIONARIO  
		(FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_EMAIL, FUN_TELEFONE, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES	("12345678901", "Ana Clara Martins", "1990-05-12", "ana.martins@gmail.com", "(11)91234-5678", "1234567-8", "0010", "12345-6", "2023-03-01", "44h", "111111111"),
		("23456789012", "Bruno Henrique Silva", "1985-08-23", "bruno.silva@gmail.com", "(21)99876-5432", "2345678-9", "0021", "23456-7", "2022-07-15", "44h", "222222222"),
		("34567890123", "Camila Rodrigues Costa", "1992-11-05", "camila.costa@gmail.com", "(11)93456-7891", "3456789-0", "0032", "34567-8", "2024-01-10", "44h", "333333333"),
		("45678901234", "Diego Pereira Lima", "1988-02-17", "diego.lima@gmail.com", "(31)97654-3210", "4567890-1", "0043", "45678-9", "2021-09-20", "44h", "444444444"),
		("56789012345", "Fernanda Souza Oliveira", "1995-12-30", "fernanda.oliveira@gmail.com", "(41)98877-6655", "5678901-2", "0054", "56789-0", "2023-06-05", "44h", "555555555");

INSERT INTO SUPERMERCADO_PRODUTO	(FK_SUP_CNPJ, FK_PRO_ID)
VALUES								("111111111", 1),  -- Supermercado Grick tem Arroz 5kg
									("222222222", 2),  -- Mercadinho Bom Preço tem Feijão Carioca
									("333333333", 3),  -- Supermais Atacado tem Açúcar Refinado
									("444444444", 4),  -- Mercado Econômico tem Café Torrado
									("555555555", 5);  -- HiperLuz tem Macarrão Espaguete

INSERT INTO PRODUTO_CONSUMIDOR	(FK_CON_CPF, FK_PRO_ID)
VALUES							("45982972800", 1),  -- Fernanda comprou Arroz 5kg
								("38294651720", 2),  -- Lucas comprou Feijão Carioca
								("57129846311", 3),  -- Mariana comprou Açúcar Refinado
								("69481235790", 4),  -- Rafael comprou Café Torrado
								("84592316708", 5);  -- Beatriz comprou Macarrão Espaguete
                                
SELECT * FROM SUPERMERCADO;

/*
CONSULTAR O AUMENTO DE R$2,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL >= R$5,00
*/

SELECT PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_PRECO AS "PREÇO ATUAL",
        TRUNCATE((PRO_PRECO +2),2) AS "PREÇO COM AJUSTE DE R$2,00"
FROM PRODUTO
WHERE PRO_PRECO >= 5;

/*
CONSULTAR A REDUÇÃO DE R$1,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL ABAIXO DE R$5,00
*/

SELECT PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		PRO_PRECO AS "PREÇO ATUAL",
        TRUNCATE ((PRO_PRECO -1),2) AS "PREÇO COM REDUÇÃO DE R$1,00"
FROM PRODUTO
WHERE PRO_PRECO <= 10;

/*
CONSULTAR COMO SERIA APLICAR UM DESCONTO DE 10% EM TODODS OS PRODUTOS
*/

SELECT PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_PRECO AS "PREÇO ATUAL",
        (PRO_PRECO - (PRO_PRECO * 0.1)) AS "PREÇO COM DESCONTO DE 10%"
FROM PRODUTO;

/*
AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO DIVIDINDO PELA METADE
*/

SELECT PRO_ID,
		PRO_NOME,
		PRO_CODIGO_BARRAS,
        PRO_QUANTIDADE
FROM PRODUTO;

UPDATE PRODUTO
SET 	PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE 	PRO_ID =1;

/*
CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE SETEMBRO DE 2025 E DEZEMBRO DE 2025
*/

SELECT  PRO_NOME 		  AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
		PRO_DATA_VALIDADE AS "DATA VALIDADE"
FROM PRODUTO
WHERE PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';

/*
CONSULTAR TODOS OS PRODUTOS QUE TENHAM PREÇO MAIOR QUE R$10 OU MENOR QUE R$4
*/

SELECT  PRO_NOME			AS "NOME",
		PRO_CODIGO_BARRAS	AS "CÓDIGO DE BARRAS",
        PRO_PRECO 			AS "PREÇO"
FROM PRODUTO
WHERE PRO_PRECO >= 10 OR PRO_PRECO <= 4;

/*
CONSULTAR OS DDS E TELEFONE DOS CONSUMIDORES SEPARADAMENTE
*/

SELECT  CON_NOME 					 AS "NOME DO CONSUMIDOR",
		CON_CPF 					 AS "CPF DO CONSUMIDOR",
        SUBSTRING(CON_TELEFONE,1,2)  AS "DD DO DELEFONE",
        SUBSTRING(CON_TELEFONE,3,90) AS "NUMERO DO TELEFONE"
FROM CONSUMIDOR;

/*
GERAR UMA FRASE CONCATENANDO:
A RAZÃO SOCIAL, CNPJ, TELEFONE E EMAIL
*/

SELECT 	CONCAT("RAZÃO SOCIAL: ", 
			CONCAT(SUP_RAZAO_SOCIAL,
				CONCAT(" | CNPJ: ",
					CONCAT(SUP_CNPJ,
						CONCAT(" | TELEFONE: ",
							CONCAT(SUP_TELEFONE,
								CONCAT(" | EMAIL:", SUP_EMAIL))))))) AS FRASE
FROM SUPERMERCADO;

/*
GERAR UMA CONSULTA QUE VERIFICA O STATUS DO ESTOQUE DOS PRODUTOS
REGRAS:
1-) QUANTIDADE <= 25: ESTOQUE BAIXO
2-) QUANTIDADE > 25 E QUANTIDADE <= 100: ESTOQUE MEDIO
3-)
*/

/*
GERAR UMMA CONSULTA QUE VERIFICA O PESO DOS PRODUTOS
RETORNAR: NOME, CODIGO DE BARRAS, QUANTIDADE, PESO E DATA DE VALIDADE. REGRAS:
1-) PESO <= 5: PESO BAIXO
2-) PESO > 5 E PESO <= 50: PESO MEDIO
3-) PESO > 50: PESO ALTO
*/

SELECT PRO_NOME AS "NOME DO PRODUTO",
		PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS",
        PRO_QUANTIDADE AS "QUANTIDADE",
        PRO_DATA_VALIDADE AS "DATA VALIDADE",
        PRO_PESO AS "PESO DO PRODUTO",
        CASE
			WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
            WHEN PRO_PESO > 5 AND PRO_PESO <= 50 THEN "PESO MÉDIO"
            WHEN PRO_PESO > 50 THEN "PESO ALTO"
		END AS "CLASSIFICAÇÃO DO PESO"
FROM PRODUTO;
        
/*
CONTAR QUANTOS CONSUMIDROES TEMOS CADRASTADOS
*/

SELECT COUNT(*)
FROM CONSUMIDOR;
/*
CONTAR QUANTOS SUPERMERCADOS TEMOS CADRASTADOS
*/

SELECT COUNT(*)
FROM SUPERMERCADO;
/*
CONTAR QUANTOS FUNCIONARIOS TEMOS CADRASTADOS
*/

SELECT COUNT(*)
FROM FUNCIONARIO;
/*
CONTAR QUANTOS PRODUTOS TEMOS CADRASTADOS
*/

SELECT COUNT(*)
FROM PRODUTO;

/*
SOMAR O PREÇO TOTAL DE TODOS OS PRODUTOS CADASTRADOS
*/

SELECT SUM(PRO_PRECO)
FROM 	PRODUTO;

SELECT CONCAT("R$", TRUNCATE(SUM(PRO_PRECO),2))AS "SOMA TOTAL"
FROM PRODUTO;

/*
CALCULAR A MEDIA DE PREÇO DOS PRODUTOS
*/

SELECT AVG(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$", TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DE PREÇO"
FROM PRODUTO;

/*
SELECIONAR O PRODUTO MAIS CARO
*/

SELECT MAX(PRO_PRECO)
FROM PRODUTO;

/*
SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE
*/

SELECT MAX(PRO_QUANTIDADE)
FROM PRODUTO;

/*
SELECIONAR O PRODUTO MAIS BARATO
*/

SELECT MIN(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOR QUANTIDADE*/

SELECT MIN(PRO_QUANTIDADE)
FROM PRODUTO;

/*
SELECIONAR A DATA E A HORA ATUAL
*/
SELECT NOW() FROM DUAL;

SELECT FUN_NOME AS "NOME DO FUNCIONÁRIO",
		DATE_FORMAT(FUN_DATA_NASCIMENTO, "%d/%m/%Y") AS "DATA DE NASCIMENTO", 
        TIMESTAMPDIFF(YEAR, FUN_DATA_NASCIMENTO, NOW()) AS "IDADE"
FROM FUNCIONARIO;

/*
FUNÇÕES MATEMATICAS:
ABS- VALOR ABSOLUTO DE UM NÚMERO
ROUD - ARREDONDAR
POWER - POTENCIA
*/

SELECT ABS(-10),
	ROUND(PRO_PRECO) AS "PRECO ARREDONDADO",
    POWER(PRO_PRECO,2) AS "PREÇO ELEVADOS AO QUADRADO"
FROM PRODUTO;

/*
UPPER, LOWER, TRIM
*/

SELECT 	UPPER(FUN_NOME) AS "MAIÚSCULAS",
		LOWER(FUN_NOME) AS "MINÚSCULAS",
        TRIM("    EU") AS "TIRANDO ESPAÇOS"
FROM FUNCIONARIO;

/*separa em grupos mostrando quantas vezes se repetiu */
SELECT PRO_QUANTIDADE,
		COUNT(*) AS "REPETIÇÕES"
FROM PRODUTO
GROUP BY PRO_QUANTIDADE; 

/*UNION*/
SELECT FUN_NOME,
		FUN_CPF
FROM FUNCIONARIO
UNION
SELECT FUN_NOME,
		FUN_CPF
FROM FUNCIONARIO;

SELECT * FROM PRODUTO;

/*UNION*/

SELECT PRO_NOME
FROM PRODUTO
UNION
SELECT "Arroz 5Kg"
FROM DUAL
UNION 
SELECT "Iogurt do Bob Esponja"
FROM DUAL;


/*UNION ALL aparece repeticao*/

SELECT PRO_NOME
FROM PRODUTO
UNION ALL
SELECT "Arroz 5Kg"
FROM DUAL
UNION ALL
SELECT "Iogurt do Bob Esponja"
FROM DUAL;

/*SELECT COM WHERE idades entre tal e tal*/

SELECT 	FUN_NOME 										AS "NOME DO FUNCIONARIO",
		FUN_CPF 										AS "CPF DO FUNCIONÁRIO",
        FUN_DATA_NASCIMENTO 							AS "DATA DE NASCIMENTO",
		TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW())	AS "IDADE"
FROM FUNCIONARIO
WHERE 	TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) >=25
AND		TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) <=35;

/*RETORNAR OS FUNCIONARIOS, CONSUMIDORES E SUPERMERCADOS COM EMAIL = A HOTMAIL OU OUTLOOK*/

SELECT CON_NOME 		AS "NOME",
		CON_CPF 		AS "CPF/CNPJ",
        CON_TELEFONE 	AS "TELEFONE",
        CON_EMAIL 		AS "EMAIL",
        "CONSUMIDOR" 	AS "TIPO"
FROM CONSUMIDOR
WHERE UPPER(CON_EMAIL) LIKE "%HOTMAIL%"
OR UPPER(CON_EMAIL) LIKE "%GMAIL%"
UNION
SELECT	FUN_NOME			AS "NOME",
		FUN_CPF 		AS "CPF/CNPJ",
        FUN_TELEFONE 	AS "TELEFONE",
        FUN_EMAIL 		AS "EMAIL",
        "FUNCIONARIO" 	AS "TIPO"
FROM FUNCIONARIO
WHERE UPPER(FUN_EMAIL) LIKE "%HOTMAIL%"
OR UPPER(FUN_EMAIL) LIKE "%GMAIL%"
UNION
SELECT 	SUP_RAZAO_SOCIAL 	AS "NOME",
		SUP_CNPJ 			AS "CPF/CNPJ",
        SUP_TELEFONE 		AS "TELEFONE",
        SUP_EMAIL 			AS "EMAIL",
        "SUPERMERCADO" 		AS "TIPO"
FROM SUPERMERCADO
WHERE UPPER(SUP_EMAIL) LIKE "%HOTMAIL%"
OR UPPER(SUP_EMAIL) LIKE "%GMAIL%";

/*CROSS JOIN:
RETORNS TODOS OS PRODUTOS E OS SUPERMERCADOS EM QUE SAO VENDIDOS
*/

SELECT 	PRODUTO.PRO_NOME 				AS "NOME",
		PRODUTO.PRO_CODIGO_BARRAS 		AS "CODIGO DE BARRAS",
        SUPERMERCADO.SUP_RAZAO_SOCIAL 	AS "RAZAO SOCIAL"
FROM 	SUPERMERCADO_PRODUTO
CROSS JOIN SUPERMERCADO
CROSS JOIN PRODUTO
WHERE 	PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID
AND 	SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ;

/*INNER JOIN:
RETORNAR APENAS OS PRODUTOS QUE FORAM COMPRADOS POR ALGUM CONSUMIDOR
*/

SELECT 	PRODUTO_CONSUMIDOR.PRO_ID 	AS "ID DA COMPRA",
		PRODUTO.PRO_NOME 			AS "NOME DO PRODUTO",
        PRODUTO.PRO_CODIGO_BARRAS 	AS "CÓDIGO DE BARRAS",
        CONSUMIDOR.CON_NOME 		AS "NOME DO CONSUMIDOR",
        CONSUMIDOR.CON_CPF 			AS "CPF DO CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO 		ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR 	ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCÍCIO COM INNER JOIN
RETORNAR APENAS OS FUNCIONARIOS QUE TRABALHAM EM UM SUPERMERCAD 
RETORNAR O NOME DO FUNCIONARIO E O NOME DO SUPERMERCADO QUE ELE TRABALHA
*/

SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL	AS "NOME SUPERMERCADO",
		FUNCIONARIO.FUN_NOME 			AS "NOME FUNCIONARIO"
FROM 	SUPERMERCADO
INNER JOIN FUNCIONARIO ON (FUNCIONARIO.FK_SUP_CNPJ = SUPERMERCADO.SUP_CNPJ);

/*EXERCÍCIO 2 INNER JOIN
RETORNAR APENAS OS PRODUTOS QUE EXISTAM EM UM SUPERMERCADO
RETORNAR O NOME DO PRODUTO E O NOME DO SUPERMERCADO QUE ELE ESTÁ DISPONÍVEL
*/

SELECT 	PRODUTO.PRO_NOME				AS "NOME DO PRODUTO",
		SUPERMERCADO.SUP_RAZAO_SOCIAL	AS "NOME DO SUPERMERCADO"
FROM 	SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO		ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*LEFT JOIN*/
INSERT INTO PRODUTO (PRO_CODIGO_BARRAS,
					PRO_NOME,
                    PRO_PESO,
                    PRO_QUANTIDADE,
                    PRO_PRECO,
                    PRO_DATA_VALIDADE)
VALUES ("33333333", "KitKat", "30", "1500", 4.50, "2026-01-01" );

SELECT PRODUTO.PRO_NOME,
		SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
LEFT JOIN SUPERMERCADO_PRODUTO 	ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMERCADO 			ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

SELECT * FROM SUPERMERCADO; 

SELECT 	PRODUTO.PRO_NOME,
		SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
RIGHT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMERCADO 		ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*SELECT COM LEFT JOIN E RIGHT JOIN*/

SELECT *
FROM (
		SELECT S.SUP_RAZAO_SOCIAL 	AS RAZAO_SOCIAL,
				F.FUN_NOME 			AS NOME_FUNCIONARIO,
                P.PRO_NOME 			AS NOME_PRODUTO,
                C.CON_NOME 			AS NOME_CONSUMIDOR
		FROM   SUPERMERCADO S
		LEFT JOIN FUNCIONARIO F 			ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        LEFT JOIN SUPERMERCADO_PRODUTO SP 	ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        LEFT JOIN PRODUTO P 				ON (SP.FK_PRO_ID = P.PRO_ID)
        LEFT JOIN PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID = PC.FK_PRO_ID)
        LEFT JOIN CONSUMIDOR C 				ON (PC.FK_CON_CPF = C.CON_CPF)
		UNION
        SELECT S.SUP_RAZAO_SOCIAL 	AS RAZAO_SOCIAL,
				F.FUN_NOME 			AS NOME_FUNCIONARIO,
                P.PRO_NOME 			AS NOME_PRODUTO,
                C.CON_NOME 			AS NOME_CONSUMIDOR
		FROM   SUPERMERCADO S
		LEFT JOIN FUNCIONARIO F 			ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        LEFT JOIN SUPERMERCADO_PRODUTO SP 	ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        LEFT JOIN PRODUTO P 				ON (SP.FK_PRO_ID = P.PRO_ID)
        LEFT JOIN PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID = PC.FK_PRO_ID)
        LEFT JOIN CONSUMIDOR C 				ON (PC.FK_CON_CPF = C.CON_CPF)
        
) SELECT_EXTERNO
ORDER BY 	SELECT_EXTERNO.RAZAO_SOCIAL ASC,
			SELECT_EXTERNO.NOME_FUNCIONARIO DESC,
			SELECT_EXTERNO.NOME_PRODUTO ASC,
			SELECT_EXTERNO.NOME_CONSUMIDOR DESC;
;

/*1 NOME DO SUPERMERCADO E NOME DOS PRODUTOS QUE ELE VENDE*/

SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL	AS "NOME DO SUPERMERCADO",
		PRODUTO.PRO_NOME				AS "PRODUTOS"
FROM 	SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO		ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*2 NOME DO FUNCIONARIO E O NOME DO MERCADO*/
SELECT 	FUNCIONARIO.FUN_NOME			AS "NOME DO FUNCIONÁRIO",
		SUPERMERCADO.SUP_RAZAO_SOCIAL 	AS "NOME DO SUPERMERCADO "
FROM SUPERMERCADO
INNER JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/*3 NOME DO CONSUMIDOR E NOME DOS PRODUTOS QUE ELE COMPROU*/
SELECT CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR",
		PRODUTO.PRO_NOME AS "NOME DO PRODUTO"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*4 NOME DOS PRODUTOS E OS RESPECTIVOS CONSUMIDORES*/
SELECT 	PRODUTO.PRO_NOME 	AS "NOME DO PRODUTO",
		CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF)
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID);

/*5 O NOME DO MERCADO E A QUANTIDADE TOTAL DE PRODUTOS*/
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL 	AS "NOME DO SUPERMERCADO ",
		COUNT(PRODUTO.PRO_ID) 			AS "QUANTIDADE TOTAL DE PRODUTOS"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
GROUP BY SUPERMERCADO.SUP_RAZAO_SOCIAL;


/*LEFT JOIN*/
/*LISTAR TODOS OS SUPERMERCADOS */
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL AS 	"SUPERMERCADO",
		PRODUTO.PRO_NOME					AS "PRODUTO"
FROM SUPERMERCADO
LEFT JOIN SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
LEFT JOIN PRODUTO ON (SUPERMERCADO_PRODUTO.FK_PRO_ID = PRODUTO.PRO_ID);

/*TODOS OS FUNCIONARIOS E O NOME DO MERCADO*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "NOME DO MERCADO",
		FUNCIONARIO.FUN_NOME AS "NOME DO FUNCIONÁRIO"
FROM FUNCIONARIO
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

SELECT * FROM FUNCIONARIO;

/*CONSUMIDORES E OS PRODUTOS QUE COMPRARAM*/
SELECT 	CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR",
		PRODUTO.PRO_NOME AS "NOME DO PRODUTO"
FROM CONSUMIDOR
LEFT JOIN PRODUTO_CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
LEFT JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID);

/*LISTE OS PRODUTOS E CONSUMIDORES*/
SELECT PRODUTO.PRO_NOME AS "NOME DO PRODUTO",
		CONSUMIDOR.CON_NOME AS "NOME DO PRODUTO"
FROM PRODUTO
LEFT JOIN PRODUTO_CONSUMIDOR ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID)
LEFT JOIN CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF);

/*MOSTRE TODOS OS SUPERMERCADOS E SEUS FUNCIONARIOS*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "NOME DO SUPERMERCADO",
		FUNCIONARIO.FUN_NOME AS "NOME DO FUNCIONÁRIO"
FROM SUPERMERCADO
LEFT JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);




/*RIGHT JOIN*/
/*PRODUTOS E OS SUPERMERCADOS QUE OS VENDEM*/
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL 	AS "NOME DO SUPERMERCADO",
		PRODUTO.PRO_NOME				AS "NOME DOS PRODUTOS"
FROM 	SUPERMERCADO
RIGHT JOIN SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO 				ON (SUPERMERCADO_PRODUTO.FK_PRO_ID = PRODUTO.PRO_ID);

/*CONSUMIDORES E OS PRODUTOS QUE COMPRARAM*/
SELECT 	CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR",
		PRODUTO.PRO_NOME	AS "NOME DOS PRODUTOS"
FROM 	CONSUMIDOR
RIGHT JOIN PRODUTO_CONSUMIDOR 	ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
RIGHT JOIN PRODUTO 				ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID);

/*EXIBA OS FUNCIONÁRIOS E OS SUPERMERCADOS */
SELECT 	FUNCIONARIO.FUN_NOME 			AS "NOME DO FUNCIONÁRIO",
		SUPERMERCADO.SUP_RAZAO_SOCIAL	AS "NOME DO SUPERMERCADO"
FROM 	FUNCIONARIO
RIGHT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/*LISTE OS SUPERMERCADOS E OS PRODUTOS INCLUINDO OS QUE AINDA NAO ESTÃO ASSOCIADOS*/
SELECT 	SUPERMERCADO.SUP_RAZAO_SOCIAL 	AS "NOME DO SUPERMERCADO",
		PRODUTO.PRO_NOME				AS "NOME DOS PRODUTOS"
FROM 	SUPERMERCADO
RIGHT JOIN SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO 				ON (SUPERMERCADO_PRODUTO.FK_PRO_ID = PRODUTO.PRO_ID);

/*TODOS OS CONSUMIDORES E OS PRODUTOS*/
SELECT 	CONSUMIDOR.CON_NOME AS "CONSUMIDOR",
		PRODUTO.PRO_NOME	AS "PRODUTO"
FROM CONSUMIDOR
RIGHT JOIN PRODUTO_CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
RIGHT JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID);





